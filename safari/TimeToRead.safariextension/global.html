<!DOCTYPE html>

<script>
	// Set up the Listeners
	safari.application.addEventListener("message", handleMessage, false);
	safari.application.addEventListener("activate", handleActivate, true);

	// http://www.walid.tn/browser-extension-development/a-step-by-step-tutorial-on-building-your-own-safari-extension-part-2.html
	// http://stackoverflow.com/questions/4965244/popups-in-a-safari-extension
	// TODO: Update manifest.m
	const gui = safari.extension.popovers[0].contentWindow
	function handleMessage(msg) {
		if (msg.name == "estimatedTime") {
			gui.estimateTime(msg);
		}

	}

	function handleActivate(event) {
		safari.application.activeBrowserWindow.activeTab.page.dispatchMessage("kickstartMyHeart", true);
	}

</script>
